<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>Profile</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="logout()">
        <ion-icon slot="icon-only" name="log-out-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding bg-light">

  <ion-card class="profile-card" *ngIf="lineProfile">
    <ion-card-header>
      <ion-item lines="none">
        <ion-avatar slot="start">
          <img [src]="lineProfile?.pictureUrl || 'assets/shapes.svg'" />
        </ion-avatar>
        <ion-label>
          <h2>{{ lineProfile?.displayName }}</h2>
          <p>
            สถานะ:
            <ion-badge [color]="getRoleColor(currentRole)">
              {{ currentRole | uppercase }}
            </ion-badge>
          </p>
        </ion-label>
      </ion-item>
    </ion-card-header>
    <ion-card-content>
      <ion-list *ngIf="currentRole === 'user' || currentRole === 'host'">
        <ion-item lines="none">
          <ion-icon name="card-outline" slot="start"></ion-icon>
          <ion-label>รหัสนักศึกษา/บุคลากร</ion-label>
          <ion-note slot="end">6XXXXXXX</ion-note>
        </ion-item>
      </ion-list>
      <ion-list *ngIf="currentRole === 'visitor'">
        <ion-item lines="none">
          <ion-icon name="qr-code-outline" slot="start"></ion-icon>
          <ion-label>Visitor Pass</ion-label>
          <ion-note slot="end" color="success">Active</ion-note>
        </ion-item>
      </ion-list>
    </ion-card-content>
  </ion-card>

  <div *ngIf="isLiffLoading" class="ion-text-center ion-padding">
    <ion-spinner></ion-spinner>
    <p class="ion-text-muted">กำลังโหลดข้อมูล...</p>
  </div>

  <ion-card class="ion-margin-top action-card">
    <ion-card-header>
      <ion-card-subtitle>เมนูหลัก</ion-card-subtitle>
    </ion-card-header>
    <ion-card-content>
      <ion-button color="dark" expand="block" (click)="openLineOA()">
        <ion-icon name="chatbubbles-outline" slot="start"></ion-icon>
        กลับไปยังแชท (LINE OA)
      </ion-button>
    </ion-card-content>
  </ion-card>

  <ion-card class="ion-margin-top dev-card">
    <ion-card-header>
      <ion-card-subtitle class="dev-header">
        DEV TOOLS: Force Change Role
      </ion-card-subtitle>
    </ion-card-header>
    <ion-card-content>
      <p class="dev-desc">
        กดปุ่มเพื่อเปลี่ยน Rich Menu และ Role
      </p>
      
      <div class="dev-grid">
        <ion-button color="medium" expand="block" (click)="debugSwitchRole('guest')">
          <ion-icon name="refresh-outline" slot="start"></ion-icon>
          Guest
        </ion-button>

        <ion-button color="success" expand="block" (click)="debugSwitchRole('visitor')">
          Visitor
        </ion-button>

        <ion-button color="tertiary" expand="block" (click)="debugSwitchRole('user')">
          User
        </ion-button>

        <ion-button color="primary" expand="block" (click)="debugSwitchRole('host')">
          Host
        </ion-button>
      </div>
    </ion-card-content>
  </ion-card>

</ion-content>
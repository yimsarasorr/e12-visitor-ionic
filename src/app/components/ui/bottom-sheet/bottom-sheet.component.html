<div
  class="sheet-container"
  [ngClass]="'state-' + currentState"
  #sheet
>
  <div
    class="sheet-header"
    (mousedown)="onTouchStart($event)"
    (touchstart)="onTouchStart($event)"
    (window:mousemove)="onTouchMove($event)"
    (window:touchmove)="onTouchMove($event)"
    (window:mouseup)="onTouchEnd()"
    (window:touchend)="onTouchEnd()"
  >
    <div class="sheet-grabber"></div>
  </div>

  <div class="sheet-content">

    @if (currentData.mode === 'building-list') {
      <div class="content-section">
        <div class="section-header">
          <h3>{{ currentData.title }}</h3>
          <ion-badge color="primary">{{ currentData.data?.length || 0 }} แห่ง</ion-badge>
        </div>

        <ion-list lines="none" class="building-list">
          <ion-item button detail="false" *ngFor="let item of currentData.data" (click)="selectBuilding(item)">
            <div class="avatar">
              <ion-icon name="business-outline"></ion-icon>
            </div>
            <ion-label>
              <h4>{{ item.name }}</h4>
              <p>{{ item.description }}</p>
            </ion-label>
            <ion-icon slot="end" name="chevron-forward-outline" class="chevron"></ion-icon>
          </ion-item>
        </ion-list>
      </div>
    }

    @if (currentData.mode === 'location-detail' && currentData.data) {
      <div class="content-section">
        <div class="section-header">
          <div>
            <h2>{{ currentData.data.name }}</h2>
            <span class="muted">{{ currentData.data.description }}</span>
          </div>
          <ion-button fill="clear" size="small" (click)="backToList()">
            <ion-icon name="close" slot="icon-only"></ion-icon>
          </ion-button>
        </div>

        <div class="action-row">
          <ion-button expand="block" color="primary" (click)="selectBuilding(currentData.data)">
            <ion-icon name="cube-outline" slot="start"></ion-icon>
            เข้าสู่อาคาร (3D)
          </ion-button>
          <ion-button expand="block" fill="outline" color="medium">
            <ion-icon name="navigate-outline" slot="start"></ion-icon>
            นำทาง
          </ion-button>
        </div>
      </div>
    }

    @if (currentData.mode === 'access-list') {
      <app-access-list></app-access-list>
    }

  </div>
</div>

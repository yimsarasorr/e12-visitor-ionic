<div class="access-list-container">
  <div class="list-header ion-padding-horizontal ion-padding-top ion-padding-bottom">
    <div class="header-row">
      <h3>พื้นที่ที่เข้าถึงได้</h3>
      @if (accessibleRooms$ | async as rooms) {
        <ion-badge color="light">
          {{ rooms.length }}
        </ion-badge>
      }
    </div>
    <ion-note class="header-subtitle">แตะเพื่อดูตำแหน่งและรายละเอียด</ion-note>
  </div>

  <div class="list-content">
    @if (accessibleRooms$ | async as rooms) {
      @if (rooms.length === 0) {
        <div class="empty-state ion-text-center ion-padding">
          <div class="empty-icon-circle">
            <ion-icon name="lock-closed-outline"></ion-icon>
          </div>
          <h4>ไม่พบรายการสิทธิ์</h4>
          <p class="ion-text-muted">กรุณาเลือก User หรือตรวจสอบสิทธิ์การเข้าถึง</p>
        </div>
      }

      @if (rooms.length > 0) {
        <ion-list lines="none" class="custom-room-list">
          @for (room of rooms; track room.id) {
            <ion-item
              button
              detail="false"
              (click)="focusRoom(room)"
              class="room-item-wrapper"
            >
              <div slot="start" class="room-box-square" [style.background]="room.color">
                <div class="room-box-inner" [style.color]="getContrastColor(room.color)">
                  <div class="box-prefix" *ngIf="getRoomDisplay(room.name).prefix">
                    {{ getRoomDisplay(room.name).prefix }}
                  </div>
                  <div class="box-number">
                    {{ getRoomDisplay(room.name).number }}
                  </div>
                </div>
              </div>

              <ion-label class="room-details">
                <div class="meta-info">
                  <span class="meta-pill">ชั้น {{ room.floor }}</span>
                  <span class="meta-text">{{ room.zoneName || 'โซนทั่วไป' }}</span>
                </div>

                @if (room.doors.length > 0) {
                  <div class="door-tags">
                    @for (door of room.doors; track door.id) {
                      <span class="door-tag" [class.allowed]="door.allowed">
                        <ion-icon [name]="door.allowed ? 'checkmark-circle' : 'close-circle'"></ion-icon>
                        {{ door.label }}
                      </span>
                    }
                  </div>
                }
              </ion-label>

              <ion-icon slot="end" name="chevron-forward-outline" color="medium" class="chevron-icon"></ion-icon>
            </ion-item>
          }
        </ion-list>
      }
    }
  </div>
</div>
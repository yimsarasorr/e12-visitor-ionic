<ion-content [fullscreen]="true" [scrollY]="false">
  <div class="screen-wrapper">
    <app-fastpass-header
      class="screen-header"
      [selectedUserId]="selectedUserId"
      (userSelected)="onUserSelected($event)"
    ></app-fastpass-header>

    <div class="view-toolbar" *ngIf="viewMode !== 'map'">
      <ion-button fill="clear" class="back-button" (click)="resetToBuildingOverview()">
        <ion-icon slot="start" name="arrow-back"></ion-icon>
        กลับ
      </ion-button>
      <h2>{{ viewMode === 'building' ? buildingData.buildingName : 'ชั้น ' + selectedFloorValue }}</h2>
    </div>

    <div class="content-container" [class.has-toolbar]="viewMode !== 'map'">
      <div *ngIf="viewMode === 'map'" class="full-size">
        <app-map-view></app-map-view>
      </div>

      <div *ngIf="viewMode === 'building'" class="full-size bg-gradient">
        <app-building-view
          [floors]="buildingData.floors"
          [activeFloor]="lastActiveFloor"
          (floorSelected)="onFloorSelected($event)">
        </app-building-view>
        
        <div class="building-info-overlay">
          <h2>{{ buildingData.buildingName }}</h2>
          <p>แตะที่ชั้นเพื่อเข้าชม</p>
        </div>
      </div>

      <div *ngIf="viewMode === 'floor'" class="full-size">
        <app-floor-plan
          [floorData]="selectedFloorData"
          [floors]="buildingData.floors"
          [activeFloorValue]="selectedFloorValue"
          (floorChange)="onFloorSelected($event)">
        </app-floor-plan>
      </div>
    </div>

    <app-bottom-sheet></app-bottom-sheet>
  </div>

</ion-content>